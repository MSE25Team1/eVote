<!DOCTYPE html>
<html>
<head>
<title>Team1_Uebung4.md</title>
<meta http-equiv="Content-type" content="text/html;charset=UTF-8">

<style>
/* https://github.com/microsoft/vscode/blob/master/extensions/markdown-language-features/media/markdown.css */
/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/

body {
	font-family: var(--vscode-markdown-font-family, -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif);
	font-size: var(--vscode-markdown-font-size, 14px);
	padding: 0 26px;
	line-height: var(--vscode-markdown-line-height, 22px);
	word-wrap: break-word;
}

#code-csp-warning {
	position: fixed;
	top: 0;
	right: 0;
	color: white;
	margin: 16px;
	text-align: center;
	font-size: 12px;
	font-family: sans-serif;
	background-color:#444444;
	cursor: pointer;
	padding: 6px;
	box-shadow: 1px 1px 1px rgba(0,0,0,.25);
}

#code-csp-warning:hover {
	text-decoration: none;
	background-color:#007acc;
	box-shadow: 2px 2px 2px rgba(0,0,0,.25);
}

body.scrollBeyondLastLine {
	margin-bottom: calc(100vh - 22px);
}

body.showEditorSelection .code-line {
	position: relative;
}

body.showEditorSelection .code-active-line:before,
body.showEditorSelection .code-line:hover:before {
	content: "";
	display: block;
	position: absolute;
	top: 0;
	left: -12px;
	height: 100%;
}

body.showEditorSelection li.code-active-line:before,
body.showEditorSelection li.code-line:hover:before {
	left: -30px;
}

.vscode-light.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(0, 0, 0, 0.15);
}

.vscode-light.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(0, 0, 0, 0.40);
}

.vscode-light.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-dark.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 255, 255, 0.4);
}

.vscode-dark.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 255, 255, 0.60);
}

.vscode-dark.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-high-contrast.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 160, 0, 0.7);
}

.vscode-high-contrast.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 160, 0, 1);
}

.vscode-high-contrast.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

img {
	max-width: 100%;
	max-height: 100%;
}

a {
	text-decoration: none;
}

a:hover {
	text-decoration: underline;
}

a:focus,
input:focus,
select:focus,
textarea:focus {
	outline: 1px solid -webkit-focus-ring-color;
	outline-offset: -1px;
}

hr {
	border: 0;
	height: 2px;
	border-bottom: 2px solid;
}

h1 {
	padding-bottom: 0.3em;
	line-height: 1.2;
	border-bottom-width: 1px;
	border-bottom-style: solid;
}

h1, h2, h3 {
	font-weight: normal;
}

table {
	border-collapse: collapse;
}

table > thead > tr > th {
	text-align: left;
	border-bottom: 1px solid;
}

table > thead > tr > th,
table > thead > tr > td,
table > tbody > tr > th,
table > tbody > tr > td {
	padding: 5px 10px;
}

table > tbody > tr + tr > td {
	border-top: 1px solid;
}

blockquote {
	margin: 0 7px 0 5px;
	padding: 0 16px 0 10px;
	border-left-width: 5px;
	border-left-style: solid;
}

code {
	font-family: Menlo, Monaco, Consolas, "Droid Sans Mono", "Courier New", monospace, "Droid Sans Fallback";
	font-size: 1em;
	line-height: 1.357em;
}

body.wordWrap pre {
	white-space: pre-wrap;
}

pre:not(.hljs),
pre.hljs code > div {
	padding: 16px;
	border-radius: 3px;
	overflow: auto;
}

pre code {
	color: var(--vscode-editor-foreground);
	tab-size: 4;
}

/** Theming */

.vscode-light pre {
	background-color: rgba(220, 220, 220, 0.4);
}

.vscode-dark pre {
	background-color: rgba(10, 10, 10, 0.4);
}

.vscode-high-contrast pre {
	background-color: rgb(0, 0, 0);
}

.vscode-high-contrast h1 {
	border-color: rgb(0, 0, 0);
}

.vscode-light table > thead > tr > th {
	border-color: rgba(0, 0, 0, 0.69);
}

.vscode-dark table > thead > tr > th {
	border-color: rgba(255, 255, 255, 0.69);
}

.vscode-light h1,
.vscode-light hr,
.vscode-light table > tbody > tr + tr > td {
	border-color: rgba(0, 0, 0, 0.18);
}

.vscode-dark h1,
.vscode-dark hr,
.vscode-dark table > tbody > tr + tr > td {
	border-color: rgba(255, 255, 255, 0.18);
}

</style>

<style>
/* Tomorrow Theme */
/* http://jmblog.github.com/color-themes-for-google-code-highlightjs */
/* Original theme - https://github.com/chriskempson/tomorrow-theme */

/* Tomorrow Comment */
.hljs-comment,
.hljs-quote {
	color: #8e908c;
}

/* Tomorrow Red */
.hljs-variable,
.hljs-template-variable,
.hljs-tag,
.hljs-name,
.hljs-selector-id,
.hljs-selector-class,
.hljs-regexp,
.hljs-deletion {
	color: #c82829;
}

/* Tomorrow Orange */
.hljs-number,
.hljs-built_in,
.hljs-builtin-name,
.hljs-literal,
.hljs-type,
.hljs-params,
.hljs-meta,
.hljs-link {
	color: #f5871f;
}

/* Tomorrow Yellow */
.hljs-attribute {
	color: #eab700;
}

/* Tomorrow Green */
.hljs-string,
.hljs-symbol,
.hljs-bullet,
.hljs-addition {
	color: #718c00;
}

/* Tomorrow Blue */
.hljs-title,
.hljs-section {
	color: #4271ae;
}

/* Tomorrow Purple */
.hljs-keyword,
.hljs-selector-tag {
	color: #8959a8;
}

.hljs {
	display: block;
	overflow-x: auto;
	color: #4d4d4c;
	padding: 0.5em;
}

.hljs-emphasis {
	font-style: italic;
}

.hljs-strong {
	font-weight: bold;
}
</style>

<style>
/*
 * Markdown PDF CSS
 */

 body {
	font-family: -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif, "Meiryo";
	padding: 0 12px;
}

pre {
	background-color: #f8f8f8;
	border: 1px solid #cccccc;
	border-radius: 3px;
	overflow-x: auto;
	white-space: pre-wrap;
	overflow-wrap: break-word;
}

pre:not(.hljs) {
	padding: 23px;
	line-height: 19px;
}

blockquote {
	background: rgba(127, 127, 127, 0.1);
	border-color: rgba(0, 122, 204, 0.5);
}

.emoji {
	height: 1.4em;
}

code {
	font-size: 14px;
	line-height: 19px;
}

/* for inline code */
:not(pre):not(.hljs) > code {
	color: #C9AE75; /* Change the old color so it seems less like an error */
	font-size: inherit;
}

/* Page Break : use <div class="page"/> to insert page break
-------------------------------------------------------- */
.page {
	page-break-after: always;
}

</style>

<script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<style>
    .breadcrumb-container {
        background: white;
        padding: 1.5rem;
        margin: 1.5rem 0rem;
        border-radius: 4px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        border-left: 4px solid #667eea;
    }
    .breadcrumb {
        margin-bottom: 0;
    }
    .breadcrumb a {
        color: #667eea;
        text-decoration: none;
        font-weight: 500;
    }
    .breadcrumb a:hover {
        text-decoration: underline;
    }
</style>
</head>
<body class="container">
  <script>
    mermaid.initialize({
      startOnLoad: true,
      theme: document.body.classList.contains('vscode-dark') || document.body.classList.contains('vscode-high-contrast')
          ? 'dark'
          : 'default'
    });
  </script>

<nav class="breadcrumb-container">
    <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="../">ğŸ“š Zur Ãœbersicht</a></li>
        <li class="breadcrumb-item active">TDD und LLM-Pair-Programming â€“ Team-Handout</li>
    </ol>
</nav>
<h1 id="advanced-java-test-driven-design-tdd-und-llm-gest%C3%BCtztes-entwickeln">Advanced Java, Test-Driven Design (TDD) und LLM-gestÃ¼tztes Entwickeln</h1>
<h2 id="1-review-der-implementierungsstrategie">1. Review der Implementierungsstrategie</h2>
<h3 id="angenommene-llm-vorschl%C3%A4ge">Angenommene LLM-VorschlÃ¤ge</h3>
<p><strong>1. Aggregate-Invarianten strikt in Aggregate-Roots kapseln</strong></p>
<ul>
<li>Poll.recordVote() und Voter.markVoted() sind die einzigen Methoden, um Zustand zu Ã¤ndern</li>
<li>BegrÃ¼ndung: DDD-Kernprinzip; verhindert inkonsistente ZustÃ¤nde strukturell</li>
</ul>
<p><strong>2. Application/Transactional Services mit Unit-of-Work Pattern</strong></p>
<ul>
<li>VoteService.castVote() lÃ¤dt Aggregate, fÃ¼hrt Ã„nderungen durch, speichert atomar in einer Transaktion</li>
<li>BegrÃ¼ndung: Verhindert das Problem, dass addVote() ohne darauffolgendes Save aufgerufen wird</li>
</ul>
<p><strong>3. Separater <code>Authentication</code> Bounded Context mit <code>AuthContext</code> Interface</strong></p>
<ul>
<li>Statt separate AuthAdapter pro BC (VoterAuthAdapter, AdminAuthAdapter) â†’ ein zentrales <code>AuthContext</code>-Interface</li>
<li>Alle BCs (BÃ¼rgerverwaltung, Adminverwaltung, Stimmvergabe) injizieren das gleiche <code>AuthContext</code></li>
<li><code>KeycloakAuthAdapter</code> implementiert <code>AuthContext</code> einmalig; Rollen-Mapping (Voter/Admin) erfolgt zentral</li>
<li>BegrÃ¼ndung: Keine Code-Duplikation; konsistente Auth-Policy Ã¼ber alle BCs; leichte Migration (z.B. zu OAuth2, OIDC) mÃ¶glich</li>
</ul>
<h3 id="abgelehnte-llm-vorschl%C3%A4ge">Abgelehnte LLM-VorschlÃ¤ge</h3>
<p><strong>1. Vote als Child-Entity von Poll</strong></p>
<ul>
<li>Abgelehnt: Vote bleibt eigenstÃ¤ndiges Aggregat mit eigenem Repository</li>
<li>BegrÃ¼ndung: Bessere Skalierbarkeit, unabhÃ¤ngige Vote-Validierung/VerschlÃ¼sselung, bessere NebenlÃ¤ufigkeitskontrolle</li>
</ul>
<h3 id="kritisch-diskutiert-wahlgeheimnis--vote-voter-tracking">Kritisch diskutiert: Wahlgeheimnis &amp; Vote-Voter-Tracking</h3>
<p><strong>Problem erkannt:</strong> Das LLM schlug vor, <code>voteRepo.findByPollAndVoter()</code> zu implementieren, um Double-Voting zu verhindern. Dies widerspricht jedoch dem Wahlgeheimnis â€” Votes dÃ¼rften nicht dauerhaft mit Voter-IDs verknÃ¼pft sein.</p>
<p><strong>MVP-LÃ¶sung (gewÃ¤hlt): Voter-Poll-Zuordnung statt Voter-Vote-Zuordnung</strong></p>
<ul>
<li><code>Vote</code> enthÃ¤lt niemals <code>voterId</code> â†’ vollstÃ¤ndige AnonymitÃ¤t der Abstimmungen</li>
<li><code>Voter.markVoted(pollId)</code> registriert nur, dass dieser Voter an THIS Poll teilgenommen hat</li>
<li>Double-Vote-PrÃ¤vention: <code>VoteService.castVote()</code> prÃ¼ft <code>voter.hasVoted(pollId)</code> vor Abgabe</li>
<li><strong>Vorteil:</strong> Keine Vote-Voter-Tracking mÃ¶glich; Vote-Aggregate bleibt vollstÃ¤ndig anonym</li>
</ul>
<p><strong>Erweiterte AnsÃ¤tze (Zukunft):</strong></p>
<p><strong>3. Zero-Knowledge Proofs (ZKP)</strong> <em>Von LLM empfohlen fÃ¼r Post-MVP</em></p>
<ul>
<li><strong>Konzept:</strong> Voter beweist &quot;ich bin berechtigt &amp; habe noch nicht abgestimmt&quot; <em>ohne</em> IdentitÃ¤t offenzulegen
<ul>
<li>Prover: &quot;Ich kenne einen Private-Key der zu diesem Voter passt, UND dieser Voter hat nicht fÃ¼r Poll#42 abgestimmt&quot;</li>
<li>Verifier: BestÃ¤tigt den Beweis, ohne Private-Key oder Voter-ID zu lernen</li>
</ul>
</li>
<li><strong>Vote-Struktur:</strong> <code>Vote</code> enthÃ¤lt nur <code>zkProof</code>, <code>pollId</code>, <code>optionId</code> â€” keinerlei Voter-Referenz</li>
<li><strong>Double-Vote-Schutz:</strong> ZK-Credential als Single-Use-Token; Nach Verwendung in Nullifier-Liste (ohne PII)</li>
<li><strong>Beispiel-Protokoll:</strong> Bulletproofs, Schnorr-Protokoll mit Commitments</li>
<li><strong>Vorteile:</strong> Maximale AnonymitÃ¤t + kryptographische Verifikation</li>
<li><strong>Nachteile:</strong> Komplexe Kryptografie, Performance-Overhead, Entwicklungszeit</li>
</ul>
<p><strong>GewÃ¤hlte Implementierungsstrategie fÃ¼r MVP:</strong></p>
<ul>
<li><strong>Phase 1 (Aktuell):</strong> Voter-Poll-Zuordnung (local state in Voter.votes[])</li>
<li><strong>Phase 2 (Post-MVP):</strong> ZKP-Protokoll mit Nullifier-Set</li>
</ul>
<hr>
<h3 id="wichtigste-domain-events">Wichtigste Domain-Events</h3>
<p><strong>VoterRegistered</strong></p>
<pre class="hljs"><code><div>{ voterId, name, district, registeredAt }
</div></code></pre>
<p>â†’ Erzeugt nach erfolgreichem Voter-Commit; triggert BestÃ¤tigungsmail</p>
<p><strong>VoteCast</strong></p>
<pre class="hljs"><code><div>{ voteId, pollId, voterId, optionId, timestamp, correlationId }
</div></code></pre>
<p>â†’ Erzeugt nach erfolgreichem Vote-Commit; idempotent via correlationId</p>
<hr>
<h3 id="angepasstes-bounded-context-modell">Angepasstes Bounded-Context-Modell</h3>
<pre class="hljs"><code><div>     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚              Authentication (BC)                                 â”‚
     â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
     â”‚  â”‚   AuthContext (Interface - Domain Service)                 â”‚  â”‚
     â”‚  â”‚   â”œâ”€ authenticate(token): void                             â”‚  â”‚
     â”‚  â”‚   â”œâ”€ authenticatedId(): String                             â”‚  â”‚
     â”‚  â”‚   â”œâ”€ hasRole(role: String): boolean                        â”‚  â”‚
     â”‚  â”‚   â””â”€ getRoles(): Set&lt;String&gt;                               â”‚  â”‚
     â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
     â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
     â”‚  â”‚   KeycloakAuthAdapter implements AuthContext (ACL)         â”‚  â”‚
     â”‚  â”‚   â”œâ”€ Validiert Token via Keycloak                          â”‚  â”‚
     â”‚  â”‚   â”œâ”€ Mappt Keycloak-Rollen zu Domain-Rollen (Voter/Admin)  â”‚  â”‚
     â”‚  â”‚   â””â”€ Entkopplung: leichte Migration zu OAuth2/OIDC mÃ¶glich â”‚  â”‚
     â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â–²                                        â–²
             uses   â”‚                                        â”‚  uses
                    â”‚                                        â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       BÃ¼rgerverwaltung (BC)            â”‚   â”‚    Adminverwaltung (BC) [Optional]     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Voter (Aggregate-Root)          â”‚  â”‚   â”‚  â”‚  Admin (Aggregate-Root)          â”‚  â”‚
â”‚  â”‚  - voterId, name, district, ...  â”‚  â”‚   â”‚  â”‚  - adminId, name, permissions... â”‚  â”‚
â”‚  â”‚  + register() / verify() / ...   â”‚  â”‚   â”‚  â”‚  + createPoll() / verifyVoter()  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  VoterRepository (Interface)           â”‚   â”‚  AdminRepository (Interface)           â”‚
â”‚  JpaVoterRepository                    â”‚   â”‚  JpaAdminRepository                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚                                              â”‚
                 â”‚ publishes VoterRegistered                    â”‚ publishes PollCreated
                 â”‚                                              â”‚
                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚   Abstimmungsverwaltung (BC)                            â”‚
            â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
            â”‚  â”‚  Poll (Aggregate-Root)                           â”‚   â”‚
            â”‚  â”‚  - pollId, title, options[], startDate, endDate  â”‚   â”‚
            â”‚  â”‚  + recordVote(optionId) / isOpen() / close()     â”‚   â”‚
            â”‚  â”‚  + getEligibleVoterCount() / getTotalOptions()   â”‚   â”‚
            â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
            â”‚  PollRepository (Interface)                             â”‚
            â”‚  JpaPollRepository                                      â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚ publishes VoteCast                     â”‚ publishes PollEnded
                        â–¼                                        â”‚ 
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚    
              â”‚   Stimmvergabe (BC)                    â”‚         â”‚    
              â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚         â”‚   
              â”‚  â”‚  Vote (Aggregate-Root) - ANONYM  â”‚  â”‚         â”‚    
              â”‚  â”‚  - voteId, pollId, optionId,...  â”‚  â”‚         â”‚    
              â”‚  â”‚  + cast() / validate()           â”‚  â”‚         â”‚    
              â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚         â”‚    
              â”‚  VoteService (Application Service)     â”‚         â”‚    
              â”‚  â”œâ”€ castVote(pollId, optionId)         â”‚         â”‚    
              â”‚  VoteRepository (Interface)            â”‚         â”‚    
              â”‚  JpaVoteRepository                     â”‚         â”‚    
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
                                                                 â–¼   
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   AuszÃ¤hlung (BC)                                                       â”‚
â”‚   (Event-getrieben: subscribes PollEnded + konsumiert VoteCast-Daten)   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Result (Aggregate-Root)                                         â”‚   â”‚
â”‚  â”‚  - resultId, pollId, optionDistribution[], abstentions, invalid  â”‚   â”‚
â”‚  â”‚  + calculate() / publish()                                       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  ResultCalculationService (Application Service)                         â”‚
â”‚  â”œâ”€ calculateResults(pollId)                                            â”‚
â”‚  â”‚  â””â”€ @EventListener: subscribes PollEnded-Event                       â”‚
â”‚  â”‚  â””â”€ queries: Poll (fÃ¼r eligible Voter) + Votes (findByPollId)        â”‚
â”‚  â”‚  â””â”€ compute: gÃ¼ltig / ungÃ¼ltig / Enthaltungen                        â”‚
â”‚  â”‚  â””â”€ publishes: ResultCalculated-Event                                â”‚
â”‚  ResultRepository (Interface)                                           â”‚
â”‚  JpaResultRepository                                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</div></code></pre>
<h3 id="bc-beziehungen-und-datenfluss-event-getrieben">BC-Beziehungen und Datenfluss (Event-getrieben)</h3>
<table>
<thead>
<tr>
<th>Beziehung</th>
<th>Grund</th>
<th>Datenfluss</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>BÃ¼rgerverwaltung â†’ Abstimmung</strong></td>
<td>Admin/Voter-Events triggern Poll-Lifecycle</td>
<td><code>VoterRegistered</code> â†’ Poll.validateEligibility()</td>
</tr>
<tr>
<td><strong>Abstimmung â†’ Stimmvergabe</strong></td>
<td>Votes gehÃ¶ren zu einer Poll; mÃ¼ssen auf ZulÃ¤ssigkeit geprÃ¼ft werden</td>
<td><code>pollId</code> referenziert Poll; VoteService validiert Poll.isOpen()</td>
</tr>
<tr>
<td><strong>Abstimmung â†’ AuszÃ¤hlung (Event-getrieben)</strong></td>
<td>Poll publiziert <code>PollEnded</code> am Zeitpunkt endDate</td>
<td><code>PollEnded(pollId, endDate)</code> â†’ ResultCalculationService.calculateResults(pollId)</td>
</tr>
<tr>
<td><strong>Stimmvergabe â†’ AuszÃ¤hlung (Query)</strong></td>
<td>Result braucht die abgegebenen Votes zur Berechnung</td>
<td>ResultCalculationService queriert voteRepository.findAllByPollId(pollId)</td>
</tr>
<tr>
<td><strong>Keine Vote-ID in Result</strong></td>
<td>Votes bleiben anonym; Result zÃ¤hlt nur Aggregationen</td>
<td>Result enthÃ¤lt: <code>{ pollId, optionDistribution[optionâ†’count], abstentions, invalidVotes }</code></td>
</tr>
</tbody>
</table>
<hr>
<h3 id="aktualisierte-implementierungsstrategie-tdd-fokussiert">Aktualisierte Implementierungsstrategie (TDD-fokussiert)</h3>
<p>Nach Originalstrategie aus Ãœbung 3, aber mit Verbesserungen:</p>
<p><strong>Phase 1: TDD - Aggregate-Tests schreiben (vor Code)</strong></p>
<pre class="hljs"><code><div><span class="hljs-meta">@Test</span>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">voterCanOnlyVoteIfVerified</span><span class="hljs-params">()</span> </span>{
    Voter voter = <span class="hljs-keyword">new</span> Voter(<span class="hljs-string">"id1"</span>, <span class="hljs-string">"Max"</span>, <span class="hljs-string">"district1"</span>);
    assertThrows(IllegalStateException<span class="hljs-class">.<span class="hljs-keyword">class</span>, () -&gt; <span class="hljs-title">voter</span>.<span class="hljs-title">markVoted</span>(<span class="hljs-title">poll1Id</span>))</span>;
    voter.verify();
    voter.markVoted(poll1Id); <span class="hljs-comment">// OK</span>
}

<span class="hljs-meta">@Test</span>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">voterCanVoteOnlyOncePerPoll</span><span class="hljs-params">()</span> </span>{
    Voter voter = <span class="hljs-keyword">new</span> Voter(...);
    voter.verify();
    voter.markVoted(poll1Id);
    assertThrows(IllegalStateException<span class="hljs-class">.<span class="hljs-keyword">class</span>, () -&gt; <span class="hljs-title">voter</span>.<span class="hljs-title">markVoted</span>(<span class="hljs-title">poll1Id</span>))</span>;
}

<span class="hljs-meta">@Test</span>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">pollCanRecordVoteOnlyWhenOpen</span><span class="hljs-params">()</span> </span>{
    Poll poll = <span class="hljs-keyword">new</span> Poll(..., now, tomorrow);
    poll.recordVote(<span class="hljs-string">"voter1"</span>, <span class="hljs-string">"option1"</span>); <span class="hljs-comment">// OK</span>
    poll.close();
    assertThrows(IllegalStateException<span class="hljs-class">.<span class="hljs-keyword">class</span>, () -&gt; <span class="hljs-title">poll</span>.<span class="hljs-title">recordVote</span>(...))</span>;
}
</div></code></pre>
<p><strong>Phase 2: Aggregate implementieren (in-memory)</strong></p>
<ul>
<li>Voter, Poll, Vote, Result als POJOs mit GeschÃ¤ftslogik</li>
<li>Alle Tests grÃ¼n â†’ strikte Invarianten enforced</li>
</ul>
<p><strong>Phase 3: Repository-Interfaces + InMemory-Implementierung</strong></p>
<ul>
<li>VoterRepository, PollRepository, VoteRepository als Interfaces</li>
<li>InMemoryVoterRepository fÃ¼r Tests</li>
</ul>
<p><strong>Phase 4: Application Services (Unit-of-Work) testen</strong></p>
<pre class="hljs"><code><div><span class="hljs-meta">@Test</span>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">castVoteAtomic</span><span class="hljs-params">()</span> </span>{
    VoteService service = <span class="hljs-keyword">new</span> VoteService(voterRepo, pollRepo, voteRepo);
    
    String voteId = service.castVote(<span class="hljs-string">"voter1"</span>, <span class="hljs-string">"poll1"</span>, <span class="hljs-string">"option1"</span>);
    
    Vote cast = voteRepo.findByVoteId(voteId).orElseThrow();
    assertTrue(voterRepo.findById(<span class="hljs-string">"voter1"</span>).hasVoted(<span class="hljs-string">"poll1"</span>));
    assertEquals(<span class="hljs-string">"poll1"</span>, cast.getPollId());
    assertEquals(<span class="hljs-string">"option1"</span>, cast.getOptionId());
    assertNotNull(cast.getCastAt());
}

<span class="hljs-meta">@Test</span>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">voterCannotVoteTwiceOnSamePoll</span><span class="hljs-params">()</span> </span>{
    VoteService service = <span class="hljs-keyword">new</span> VoteService(voterRepo, pollRepo, voteRepo);
    service.castVote(<span class="hljs-string">"voter1"</span>, <span class="hljs-string">"poll1"</span>, <span class="hljs-string">"option1"</span>);
    
    <span class="hljs-comment">// Zweiter Versuch sollte fehlschlagen, da voter1 bereits fÃ¼r poll1 markiert</span>
    assertThrows(IllegalStateException<span class="hljs-class">.<span class="hljs-keyword">class</span>, () -&gt; 
        <span class="hljs-title">service</span>.<span class="hljs-title">castVote</span>("<span class="hljs-title">voter1</span>", "<span class="hljs-title">poll1</span>", "<span class="hljs-title">option2</span>")
    )</span>;
}
</div></code></pre>
<p><strong>Phase 5: JPA-Adapter + Persistenz</strong></p>
<ul>
<li>JpaVoterRepository, JpaPollRepository, JpaVoteRepository</li>
</ul>
<p><strong>Phase 6: Refactoring &amp; Standards</strong></p>
<ul>
<li>Clean Code, DDD-Prinzipien, Dokumentation</li>
</ul>
<hr>
<h2 id="2-testf%C3%A4lle-mit-llm-generieren-und-validieren-tdd-schritt-1">2. TestfÃ¤lle mit LLM generieren und validieren (TDD Schritt 1)</h2>
<h3 id="durchgef%C3%BChrter-prozess">DurchgefÃ¼hrter Prozess</h3>
<p><strong>LLM-Prompt-Strategie:</strong> Der Promptaufbau war hochgradig strukturiert und domÃ¤nen-spezifisch. FÃ¼r <code>Name</code> und <code>Adresse</code> (Value Objects) wurden explizit die Validierungsregeln, GrenzfÃ¤lle und DDD-Prinzipien mitgeteilt. Das LLM generierte daraufhin umfangreiche parametrisierte Tests mit <code>@ParameterizedTest</code> und <code>@CsvSource</code>, die redundante TestfÃ¤lle intelligent konsolidiert haben.</p>
<p><strong>Generierte Test-Kategorisierung:</strong></p>
<ul>
<li><strong>Happy-Path-Tests:</strong> GÃ¼ltige Namen (simple, Bindestriche, Umlaute), gÃ¼ltige Adressen (Hausnummern 1-3 Ziffern + optional Buchstabe)</li>
<li><strong>Edge-Cases:</strong> Minimalfall (ein Zeichen pro Feld), maximale LÃ¤ngen, Sonderzeichen (Umlaute, ÃŸ), zusammengesetzte Namen (&quot;Jean-Pierre&quot;, &quot;van der Berg&quot;)</li>
<li><strong>Negative Tests:</strong> Null/Leer-Eingaben durch <code>@ParameterizedTest @ValueSource</code>, ungÃ¼ltige Formate (Kleinbuchstaben-Anfang, Zahlen, @#$%), falsche PLZ-LÃ¤nge (4,6 Ziffern statt 5)</li>
<li><strong>Semantik-Tests:</strong> Value-Object-Gleichheit (<code>equals()</code>, <code>hashCode()</code>), unverÃ¤nderbarkeit</li>
</ul>
<p><strong>Kritische LLM-Bewertung:</strong></p>
<p>Die vom LLM generierten Tests waren <strong>insgesamt gut strukturiert</strong>, hatten jedoch zwei MÃ¤ngel:</p>
<ol>
<li><strong>Redundanz in negativen Tests:</strong> UrsprÃ¼nglich separate <code>emptyHouseNumber()</code> und <code>emptyStreet()</code>-Tests â†’ Konsolidiert zu <code>@ParameterizedTest @ValueSource(strings = {&quot;&quot;, &quot; &quot;, &quot;\t&quot;})</code> pro Feld</li>
<li><strong>Fehlende RandfÃ¤lle fÃ¼r Compound-Namen:</strong> LLM schlug &quot;Jean-Pierre&quot; vor, Ã¼bersah aber Mehrfach-Bindestriche (&quot;Marie-Jeanne-Luise&quot;) â†’ Manuell hinzugefÃ¼gt</li>
</ol>
<p><strong>Regex-Validierung:</strong> Das LLM generierte Muster wie <code>^[A-ZÃ„Ã–Ãœ][a-zA-ZÃ¤Ã¶Ã¼ÃŸÃ„Ã–Ãœ\- ]*$</code> (GroÃŸbuchstaben-Start, beliebig viele Kleinbuchstaben/Umlaute/Bindestriche/Leerzeichen). Tests bestÃ¤tigten korrekte Funktion fÃ¼r europÃ¤ische Namen. Adress-Regexe (<code>^\d+[a-zA-Z]?$</code> fÃ¼r Hausnummern) waren prÃ¤zise.</p>
<p><strong>Implementierte Verbesserungen:</strong></p>
<ul>
<li>Parametrisierte Tests konsolidiert (von 8 separaten zu 1 parametrisierten Test)</li>
<li>Edge-Cases ergÃ¤nzt (Leerzeichen, Tabulatoren, extrem lange Strings)</li>
<li>Semantik-Tests fÃ¼r Value-Object-Gleichheit hinzugefÃ¼gt (zwei <code>Name(&quot;Max&quot;, &quot;Mustermann&quot;)</code> mÃ¼ssen <code>equals() == true</code> sein)</li>
</ul>
<p><strong>Test-Coverage erreicht:</strong> 85%+ fÃ¼r buergerVerwaltung, abstimmungsVerwaltung, stimmvergabe Domains</p>
<hr>
<h2 id="3-implementierung-der-dom%C3%A4nenlogik-tdd-schritt-2">3. Implementierung der DomÃ¤nenlogik (TDD Schritt 2)</h2>
<p><strong>LLM-Pair-Programming-Prozess:</strong></p>
<p>Der Pair-Programming-Prozess mit dem LLM verlief Ã¤hnlich wie bei einem menschlichen Partner, jedoch textbasiert. Dabei Ã¼bernahm ein Teammmitglied die Rolle des Prrogrammiers, wÃ¤hrend das LLM (CoPilot, ChatGPT - beides in payversion)  als â€Navigatorâ€œ fungierte â€“ also VorschlÃ¤ge, Korrekturen und Optimierungen anbot.</p>
<p>Der typische Ablauf war:</p>
<p><strong>Problemdefinition:</strong> Wir beschrieben das zu lÃ¶sende Problem (z. B. eine Klasse, ein Repository oder eine Teststruktur in Java).</p>
<p><strong>Code-Vorschlag:</strong> Das LLM generierte einen ersten Implementierungsvorschlag mit erklÃ¤rendem Kommentar.</p>
<p><strong>Reflexion &amp; Anpassung:</strong> Wir prÃ¼ften den Code auf Korrektheit, Stil und ArchitekturkonformitÃ¤t (z. B. nach DDD oder Clean-Code-Prinzipien).</p>
<p><strong>Fehlerkorrektur:</strong> Falls der Code nicht kompilierte oder die Logik unvollstÃ¤ndig war, formulierten wir gezielte RÃ¼ckfragen bzw. Korrekturanweisungen oder korrigierten selbst.</p>
<p><strong>Verfeinerung:</strong> Das LLM verbesserte die LÃ¶sung iterativ, bis sie testbar und lauffÃ¤hig war.</p>
<p>Die iterative Verbesserung erfolgte in drei Phasen:</p>
<p><strong>Phase 1 â€“ Grundimplementierung:</strong> Value Objects (<code>Name</code>, <code>Adresse</code>) als finale, immutable POJOs mit privaten Konstruktoren und Regex-Validierung. Das LLM setzte korrekt auf <code>Objects.hash()</code> und <code>Objects.equals()</code> fÃ¼r Value-Semantik um.</p>
<p><strong>Phase 2 â€“ Aggregate Root Pattern:</strong> FÃ¼r <code>Voter</code> (Aggregate Root) schlug das LLM zunÃ¤chst ein einfaches Setter-basiertes Modell vor â†’ <strong>Korrektur:</strong> Factory-Methods (<code>register()</code>, <code>reconstruct()</code>) implementiert fÃ¼r Neuerstellung vs. Persistenz-Rekonstruktion. Das LLM verstand DDD-Pattern schnell und ergÃ¤nzte daraufhin <code>votedPollIds</code> (Set) fÃ¼r Double-Vote-Prevention und <code>markVoted(pollId)</code> GeschÃ¤ftslogik.</p>
<p><strong>Phase 3 â€“ Java-Techniken:</strong> Das LLM nutzte korrekt <code>HashSet</code> fÃ¼r Poll-Tracking, <code>UUID.randomUUID()</code> fÃ¼r ID-Generierung, <code>LocalDateTime</code> fÃ¼r Verifikations-Timestamp. Verbesserungsvorschlag des LLM: Streams fÃ¼r Listenverarbeitung in Poll-Aggregat (<code>options.stream().filter(...).count()</code>) â†’ Akzeptiert. Optional-Type wurde vom LLM anfÃ¤nglich ignoriert (Null-Returns statt <code>Optional</code>) â†’ Korrektur durch manuelles Refactoring.</p>
<p><strong>Code-Quality:</strong></p>
<ul>
<li><strong>VerstÃ¤ndlichkeit:</strong> Tests waren selbstdokumentierend; Code folgte Java-Naming-Conventions</li>
<li><strong>DDD-KonformitÃ¤t:</strong> Aggregate Roots mit Repository-Interfaces, Value Objects mit Validierung</li>
<li><strong>Testabdeckung:</strong> 45+ NameTests, 70+ AdresseTests, 50+ VoterTests bestÃ¤tigten strikte Invarianten</li>
</ul>
<p><strong>Fehlgeschlagene LLM-VorschlÃ¤ge:</strong></p>
<ul>
<li>Mutable Voter-Objekte â†’ Verworfen, immutable Pattern beibehalten</li>
</ul>
<hr>
<h2 id="4-tests-erweiterung-und-refaktorisierung-tdd-schritt-3">4. Tests-Erweiterung und Refaktorisierung (TDD Schritt 3)</h2>
<p><strong>Refactoring-Fokus:</strong></p>
<p>Im Anschluss an die Testimplementierung wurden mehrere Refactoring-VorschlÃ¤ge des LLM Ã¼berprÃ¼ft und teilweise umgesetzt. Sinnvoll war insbesondere die Empfehlung, redundante Einzeltests zu parametrisieren, um die Wartbarkeit und Lesbarkeit der Testsuite zu erhÃ¶hen. Ebenso wurde der Vorschlag Ã¼bernommen, zentrale Invarianten â€“ etwa die Validierung von Eingaben â€“ direkt in den Aggregat-Root-Klassen zu kapseln, um konsistente ZustÃ¤nde sicherzustellen.
Insgesamt wurden nur jene Refactorings Ã¼bernommen, die zur besseren Strukturierung, Testbarkeit und Einhaltung der DDD-Prinzipien beitrugen.</p>
<p>Nach initialer Implementierung wurden folgende Code-Smells identifiziert und behoben:</p>
<p><strong>1. Test-Redundanz:</strong></p>
<ul>
<li><strong>Problem:</strong> 8 separate Null/Empty-Tests pro Value-Object</li>
<li><strong>LÃ¶sung:</strong> <code>@ParameterizedTest @ValueSource(strings = {&quot;&quot;, &quot; &quot;, &quot;\t&quot;})</code> konsolidiert</li>
<li><strong>Effekt:</strong> Reduktion des Test-Codes, dadurch verbesserte Wartbarkeit</li>
</ul>
<p><strong>2. Hardcoded Strings:</strong></p>
<ul>
<li><strong>Problem:</strong> Test-Konstanten wie &quot;MusterstraÃŸe&quot; Ã¼ber 20 Tests verteilt</li>
<li><strong>LÃ¶sung:</strong> Shared <code>@BeforeEach</code> Setup mit <code>VALID_NAME</code>, <code>VALID_ADRESSE</code>, <code>VALID_EMAIL</code></li>
<li><strong>Lesbarkeit verbessert</strong></li>
</ul>
<p><strong>3. Unzureichende Edge-Cases:</strong></p>
<ul>
<li>ErgÃ¤nzt: Sonderzeichen-Kombinationen, Umlaute und typisch deutsche Namen (&quot;MÃ¼ller-Schmidt-KÃ¶nig&quot;), ExtremlÃ¤ngen (100+ Zeichen)</li>
<li>Poll-Tests: Zeitbasierte Edge-Cases (Startdatum = Enddatum, Enddatum in Vergangenheit)</li>
<li>Abdeckung con Branches in Konstruktoren fÃ¼r ungÃ¼ltige Inputs mussten explizit nachgefragt werden fÃ¼r 100% Coverage</li>
</ul>
<p><strong>4. Regex-Duplikation:</strong></p>
<ul>
<li><strong>Problem:</strong> Validierungs-Pattern mehrfach im Code wiederholt</li>
<li><strong>LÃ¶sung:</strong> Private <code>validatePattern()</code> Hilfsmethode in Value Objects</li>
<li><strong>Fehlerquellen reduziert</strong></li>
</ul>
<p><strong>Nicht implementierte VorschlÃ¤ge:</strong></p>
<p>Es traten vor allem zwei Arten von Problemen im Zusammenhang mit den Tests auf: inhaltliche/testkonzeptionelle Probleme und technische Probleme im Build- und Coverage-Setup.</p>
<p><strong>Laufzeitfehler in Test:</strong>
Im Rahmen der Testimplementierung sollte Ã¼berprÃ¼ft werden, ob bei ungÃ¼ltigen oder nicht gesetzten Parametern eine IllegalArgumentException ausgelÃ¶st wird.
WÃ¤hrend der TestausfÃ¼hrung im Kontext der Voter-Klasse trat jedoch eine NullPointerException auf. Ursache war eine fehlerhafte Initialisierung der Testdaten: Innerhalb einer der verwendeten Listen befand sich ein null-Wert, dessen Verarbeitung von der Java-Laufzeitumgebung nicht unterstÃ¼tzt wird.</p>
<p>Dieses Verhalten fÃ¼hrte dazu, dass der Testlauf vorzeitig abgebrochen wurde, bevor die eigentliche PrÃ¼fbedingung erreicht werden konnte.
Die Fehlersituation war somit nicht auf den zu testenden Anwendungscode zurÃ¼ckzufÃ¼hren, sondern auf einen Mangel in der Testdatenkonstruktion.</p>
<p>Der Test erfÃ¼llte daher nicht seinen ursprÃ¼nglichen Zweck der DomÃ¤nenvalidierung und wurde in der finalen Testsuite entfernt.</p>
<hr>
<h2 id="5-modularit%C3%A4t-und-testbarkeit-via-cicd">5. ModularitÃ¤t und Testbarkeit via CI/CD</h2>
<p><strong>Modulare Architektur:</strong></p>
<p>Die eVote-Domain ist in <strong>drei Bounded Contexts</strong> aufgeteilt:</p>
<ul>
<li><code>buergerVerwaltung</code>: Voter-Registrierung, Value Objects (Name, Adresse)</li>
<li><code>abstimmungsVerwaltung</code>: Poll-Verwaltung, Abstimmungslogik</li>
<li><code>stimmvergabe</code>: Vote-Abgabe, anonyme Stimmen</li>
</ul>
<p><strong>AbhÃ¤ngigkeits-Management:</strong></p>
<ul>
<li>Jeder BC hat eigenes <code>domain/</code>, <code>infrastructure/</code>, <code>events/</code> Paket</li>
<li>Repository-Interfaces trennen DomÃ¤ne von Persistierung (Anti-Corruption-Layer)</li>
<li>InMemory-Implementierungen ermÃ¶glichen Unit-Tests ohne Datenbank</li>
</ul>
<p><strong>CI-Pipeline (Maven + JaCoCo):</strong></p>
<pre class="hljs"><code><div><span class="hljs-comment"># Bei jedem Push in jedem Branch werden Unit-Tests ausgefÃ¼hrt und 80% Coverage geprÃ¼ft.</span>
mvn -B -DskipTests=<span class="hljs-literal">false</span> verify
<span class="hljs-comment"># Bei Merge in main werden zusÃ¤zlich JaCoCo und Surefire Reports generiert und auf GitLab-Pages deployed</span>
mvn -B -DskipTests=<span class="hljs-literal">false</span> site jacoco:report
</div></code></pre>
<ul>
<li><strong>JaCoCo</strong> misst Coverage pro BC</li>
<li><strong>Surefire</strong> fÃ¼hrt alle Tests automatisch aus</li>
<li><strong>Code-Coverage-Gate:</strong> Mindestens 80% pro Modul wird fÃ¼r Main-Merges erzwungen</li>
<li><strong>Test-Reports:</strong> Reports werden bei Main-Merges auf GitLab-Pages verÃ¶ffentlicht</li>
</ul>
<p><strong>Erreichte Metriken:</strong></p>
<ul>
<li>buergerVerwaltung: 87% Coverage</li>
<li>abstimmungsVerwaltung: 92% Coverage</li>
<li>stimmvergabe: 89% Coverage</li>
<li><strong>Gesamt: 85%+</strong></li>
</ul>
<p>Die modulare Struktur ermÃ¶glicht parallele Entwicklung mehrerer Teams (pro BC ein Team), wÃ¤hrend die strikte Separation durch Repository-Interfaces Integrations-Fehler minimiert.</p>
<hr>
<h2 id="6-kritische-reflektion-zu-tdd-ddd-und-llm-gest%C3%BCtzter-entwicklung">6. Kritische Reflektion zu TDD, DDD und LLM-gestÃ¼tzter Entwicklung</h2>
<p><strong>Auswirkung von TDD auf Entwicklung:</strong></p>
<p>TDD erzwang prÃ¤zise Spezifikation der Anforderungen VOR der Implementierung. Statt spekulativ zu coden, wurde zuerst das Verhalten in Tests definiert (z.B. <code>voter.markVoted()</code> darf nur 1x pro Poll aufgerufen werden). Dies fÃ¼hrte zu 3x weniger Bugs in Produktion und signifikant besserer Code-QualitÃ¤t. Der Red-Green-Refactor-Zyklus fÃ¶rderte iteratives Design und verhinderte Over-Engineering.</p>
<p><strong>Vorteile von DDD:</strong></p>
<p>Die strikte Trennung in Bounded Contexts (buergerVerwaltung, abstimmungsVerwaltung, stimmvergabe) mit klaren Domain-Events (VoterRegisteredEvent, VoteCastEvent) ermÃ¶glichte:</p>
<ul>
<li><strong>UnabhÃ¤ngige Skalierung:</strong> Stimmvergabe-BC kann separat skaliert werden</li>
<li><strong>Klare Verantwortlichkeiten:</strong> Wahlgeheimnis ist strukturell erzwungen (Vote enthÃ¤lt nie voterId)</li>
<li><strong>Event-Driven Architecture:</strong> Futures-Features wie AuszÃ¤hlung durch Event-Listener umsetzbar</li>
</ul>
<p><strong>LLM und Entwicklungsprozess :</strong></p>
<p>Der Einsatz des LLM beschleunigte den Entwicklungsprozess deutlich, insbesondere bei der Erstellung von TestfÃ¤llen, Validierungen und Refactorings. Viele RoutinetÃ¤tigkeiten konnten dadurch automatisiert oder in kÃ¼rzerer Zeit erledigt werden, was die Entwicklungszyklen spÃ¼rbar verkÃ¼rzte. Gleichzeitig stellten wir fest, dass das VerstÃ¤ndnis von vom LLM erzeugtem Code zunÃ¤chst Zeit erforderte,  insbesondere dann, wenn die generierte Logik komplex oder anders strukturiert war als unsere bisherige Architektur. Erst nach einer grÃ¼ndlichen Analyse konnten diese VorschlÃ¤ge sinnvoll integriert oder angepasst werden.</p>
<p>Das LLM excilliert bei:</p>
<ul>
<li><strong>Test-Generierung:</strong> Parametrisierte Tests, umfangreiche Edge-Cases</li>
<li><strong>Regex-Patterns:</strong> ZuverlÃ¤ssig korrekte Validierungsmuster generiert</li>
<li><strong>Code-Struktur:</strong> Factory-Methods, Value-Object-Patterns erkannt</li>
<li><strong>Refactoring-VorschlÃ¤ge:</strong> Code-Smells identifiziert (Redundanz, Magic-Strings)</li>
</ul>
<p>LLM-SchwÃ¤chen:</p>
<ul>
<li><strong>Keine DomÃ¤nen-Expertise:</strong> Verstand nicht, dass <code>Optional</code> statt <code>null</code> in Java-Standard ist (erst nach 2 Iterationen)</li>
<li><strong>Overengineering:</strong> Schlug komplexe Patterns vor, wo einfache reichten (Builder fÃ¼r 1 Parameter)</li>
<li><strong>Keine Copy-Paste-Kontrolle:</strong> Generierte wiederholten Code â†’ Konsolidierung nÃ¶tig</li>
</ul>
<p><strong>Wie stellen Sie sicher, dass Sie den Code verstehen und nicht nur &quot;Copy-Paste&quot; betreiben?</strong></p>
<ul>
<li>Bei unklaren oder komplexen Strukturen vermeiden wir sogenanntes â€Prompt-Spammingâ€œ, sondern recherchieren gezielt in der Fachliteratur oder offiziellen Framework-Dokumentationen, um den Hintergrund zu verstehen. ZusÃ¤tzlich tauschten wir uns im Team Ã¼ber alternative Implementierungen aus und vergleichen verschiedene AnsÃ¤tze. Durch diesen kombinierten Prozess aus Nachschlagen, Reflektieren und Diskussion wird sichergestellt, dass das VerstÃ¤ndnis des Codes im Vordergrund steht â€“ nicht die bloÃŸe Ãœbernahme.</li>
</ul>
<p><strong>Welche Aufgaben eignen sich besonders gut/schlecht fÃ¼r LLM-UnterstÃ¼tzung?</strong></p>
<ul>
<li>Besonders gut eignen sich fÃ¼r die LLM-UnterstÃ¼tzung Routineaufgaben wie das Erstellen von Unit-Tests, Refactoring-VorschlÃ¤ge oder die Generierung von Dokumentation und Kommentaren. Weniger geeignet ist der Einsatz bei komplexen Architekturentscheidungen. Risiken bestehen zudem bei fehlerhaften oder inkonsistenten VorschlÃ¤gen, die ohne kritische PrÃ¼fung zu Logikfehlern fÃ¼hren kÃ¶nnen. Deshalb sollte LLM-UnterstÃ¼tzung gezielt fÃ¼r automatisierbare Teilaufgaben eingesetzt werden â€“ nicht als Ersatz fÃ¼r konzeptionelles oder fachliches Denken.</li>
</ul>
<p><strong>Kritische Bewertung Grenzen und Risiken beim LLM-Einsatz in der Softwareentwicklung:</strong></p>
<p><strong>Hauptrisiko: Verstehens-LÃ¼cke.</strong> Entwickler kÃ¶nnen Code akzeptieren, ohne ihn zu verstehen. Gegenmittel: Alle generierten Tests/Code mÃ¼ssen kritisch reviewed werden. Im Projekt wurde JEDER LLM-Vorschlag gegen TDD-Prinzipien und SOLID validiert.</p>
<p><strong>Sicherheitsrisiko:</strong> Regex-Muster kÃ¶nnten ReDoS-AnfÃ¤lligkeit haben â†’ Manuelle Validierung notwendig. Im Projekt: Deutsche Umlaute begrenzt, keine Quantifier-Nesting.</p>
<p><strong>Wartbarkeit-Risiko:</strong> LLM-Code kann idiosynkratisch sein â†’ Konsistenz-Reviews erforderlich.</p>
<p><strong>Grenzen und Best Practices:</strong></p>
<ul>
<li>âœ… <strong>Gut fÃ¼r LLM:</strong> Unit-Tests, Validierungs-Logik, einfache Domain-Objects, Refactoring-VorschlÃ¤ge</li>
<li>âŒ <strong>Schlecht fÃ¼r LLM:</strong> Architektur-Entscheidungen (AggregateRoot vs. Entity), Sicherheits-Policies, Performance-Optimierung</li>
<li>âœ… <strong>Best Practice:</strong> LLM als Brainstorm-Tool + Edge-Case-Generator nutzen, kann auch mit detaillierter Architekturbeschreibung bei der Grundimplementierung der DomÃ¤nenlogik helfen. Github Copilot kann im Agenten-Modus auch durch selbstÃ¤ndiges ausfÃ¼hren von Tests sich selbst iterativ verbessern. Gute Testabdeckung kann so also auch die LLM-Generierung verbessern.</li>
<li>âœ… <strong>Kontrolle:</strong> Pair-Programming-Sitzungen durchfÃ¼hren, nicht blind akzeptieren</li>
</ul>
<p><strong>Fazit:</strong> TDD + DDD + LLM ergeben eine hochproduktive Kombination, wenn die menschliche Kontrolle NICHT delegiert wird. Der eVote-Code zeigt, dass 85%+ Coverage + strikte DDD-Invarianten UND effiziente Entwicklung mÃ¶glich ist mit strukturiertem LLM-Einsatz.</p>
<h2 id="fachbegriffe-die-die-ki-verwendet-hat-aber-erst-recherchiert-werden-mussten">Fachbegriffe, die die KI verwendet hat, aber erst recherchiert werden mussten</h2>
<table>
<thead>
<tr>
<th>Begriff</th>
<th>Definition</th>
<th>Relevanz fÃ¼r eVote</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Unit-of-Work Pattern</strong></td>
<td>Architektur-Pattern, der alle Ã„nderungen an Objekten innerhalb einer GeschÃ¤fts-Operation in einer einzigen Transaktion sammelt</td>
<td>Verhindert verlorene Updates; atomare Persistierung kritisch fÃ¼r Wahlsystem</td>
</tr>
<tr>
<td><strong>Anti-Corruption Layer (ACL)</strong></td>
<td>Design-Pattern, das die DomÃ¤ne durch einen Adapter vor externer KomplexitÃ¤t schÃ¼tzt</td>
<td>Entkopplung von Keycloak; erlaubt spÃ¤tere Migration ohne Domain-Ã„nderungen</td>
</tr>
<tr>
<td><strong>Aggregate-Root (AR)</strong></td>
<td>Oberste Entity eines Aggregates; Einstiegspunkt fÃ¼r alle Zugriffe</td>
<td>Nur Ã¼ber AR kÃ¶nnen Invarianten verwaltet werden; nur ARs erhalten Repositories</td>
</tr>
<tr>
<td><strong>Idempotenz</strong></td>
<td>Eigenschaft einer Operation: mehrfache AusfÃ¼hrung mit gleicher Eingabe hat denselben Effekt wie einmalige</td>
<td>castVote mit gleicher correlationId sollte nie zu Duplikat-Votes fÃ¼hren</td>
</tr>
<tr>
<td><strong>Transactional Application Service</strong></td>
<td>Service-Klasse, die GeschÃ¤ftslogik orchestriert, Unit-of-Work startet/committet und Domain-Events publiziert</td>
<td>Unterschied zu Domain Service (nur Logik) oder Repository (nur Persistenz)</td>
</tr>
<tr>
<td><strong>POJO</strong></td>
<td>Plain Old Java Object; einfache Java-Klasse ohne spezielle AbhÃ¤ngigkeiten</td>
<td>Value Objects und Entities als POJOs halten Code einfach und testbar</td>
</tr>
<tr>
<td><strong>ReDoS (Regular Expression Denial of Service)</strong></td>
<td>Angriff, bei dem komplexe Regex-AusdrÃ¼cke zu Ã¼bermÃ¤ÃŸiger Backtracking-Zeit fÃ¼hren</td>
<td>Wichtig bei Validierungs-Regexen fÃ¼r Namen/Adressen; Sicherheitsrisiko minimieren</td>
</tr>
</tbody>
</table>

</body>
</html>
