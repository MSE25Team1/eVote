<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>Adresse.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">evote</a> &gt; <a href="index.source.html" class="el_package">evote.buergerverwaltung.domain.valueobjects</a> &gt; <span class="el_source">Adresse.java</span></div><h1>Adresse.java</h1><pre class="source lang-java linenums">package evote.buergerverwaltung.domain.valueobjects;

/**
 * Adresse - Value Object für Postanschriften
 *
 * Unveränderbare Darstellung einer deutschen Postadresse mit englischer Unterstützung.
 * Validiert alle Felder nach deutschen Standards:
 * - Street (Straße): Buchstaben, Umlaute, Zahlen, Bindestriche, Punkte, Leerzeichen
 * - HouseNumber (Hausnummer): 1-3 Ziffern, optional gefolgt von einem Buchstaben (z.B. &quot;12a&quot;)
 * - AddressComplement (Adresszusatz): Optional (z.B. &quot;Penthouse&quot;, &quot;3. OG&quot;, &quot;Apartment 42&quot;)
 * - PostalCode (PLZ): Genau 5 Ziffern (deutsches Format 00001-99999)
 * - City (Stadt): Buchstaben, Umlaute, Bindestriche, Leerzeichen
 *
 * Als Value Object implementiert dieses Record Wert-Semantik (nicht Identitäts-Semantik):
 * - Zwei Adressen mit gleichen Werten sind äquivalent
 * - Unveränderbar nach Erstellung
 * - Keine Geschäftslogik, nur Validierung
 * - Records signalisieren automatisch die Immutabilität und Value-Semantik
 */
public record Adresse(
        String street,            // Straße
        String houseNumber,       // Hausnummer
        String addressComplement, // Adresszusatz (optional)
        String postalCode,        // PLZ
        String city               // Stadt
) {

    /**
     * Compact constructor for validation.
     * Street validation:
     * - Allows letters (including German umlauts: ä, ö, ü, ß)
     * - Allows digits, hyphens, periods, and spaces
     * - Example: &quot;Musterstraße&quot;, &quot;Königin-Luise-Str.&quot;, &quot;Zur Alten Mühle&quot;
     *
     * House number validation:
     * - 1-3 digits optionally followed by a single letter
     * - Examples: &quot;1&quot;, &quot;12&quot;, &quot;999&quot;, &quot;12a&quot;, &quot;42b&quot;
     * - Invalid: &quot;12ab&quot;, &quot;a1&quot;, &quot;12-34&quot;
     *
     * Postal code validation:
     * - Exactly 5 digits (German format)
     * - Range: 00001 - 99999
     * - Examples: &quot;10115&quot;, &quot;50667&quot;, &quot;80331&quot;
     *
     * City validation:
     * - Allows letters (including umlauts)
     * - Allows hyphens and spaces for compound city names
     * - Examples: &quot;Berlin&quot;, &quot;Köln&quot;, &quot;Baden-Baden&quot;, &quot;Berlin-Mitte&quot;
     *
     * Address complement:
     * - Optional field (pass null or empty string)
     * - For apartment numbers, floor numbers, etc.
     * - Examples: &quot;Penthouse&quot;, &quot;3. OG&quot;, &quot;Wohnung 42&quot;
     *
     * @throws IllegalArgumentException if any field fails validation
     */
<span class="fc" id="L57">    public Adresse {</span>
<span class="fc bfc" id="L58" title="All 4 branches covered.">        if (street == null || street.trim().isEmpty())</span>
<span class="fc" id="L59">            throw new IllegalArgumentException(&quot;Street must not be null or empty&quot;);</span>
<span class="fc bfc" id="L60" title="All 4 branches covered.">        if (houseNumber == null || houseNumber.trim().isEmpty())</span>
<span class="fc" id="L61">            throw new IllegalArgumentException(&quot;House number must not be null or empty&quot;);</span>
<span class="fc bfc" id="L62" title="All 4 branches covered.">        if (postalCode == null || !postalCode.trim().matches(&quot;^[\\d]{5}$&quot;))</span>
<span class="fc" id="L63">            throw new IllegalArgumentException(&quot;Postal code must be exactly 5 digits&quot;);</span>
<span class="fc bfc" id="L64" title="All 4 branches covered.">        if (city == null || city.trim().isEmpty())</span>
<span class="fc" id="L65">            throw new IllegalArgumentException(&quot;City must not be null or empty&quot;);</span>

        // Trim all values first before validation
<span class="fc" id="L68">        street = street.trim();</span>
<span class="fc" id="L69">        houseNumber = houseNumber.trim();</span>
<span class="fc bfc" id="L70" title="All 2 branches covered.">        addressComplement = addressComplement == null ? &quot;&quot; : addressComplement.trim();</span>
<span class="fc" id="L71">        postalCode = postalCode.trim();</span>
<span class="fc" id="L72">        city = city.trim();</span>

        // Validation regex patterns for German addresses
<span class="fc" id="L75">        String streetRegex = &quot;^[A-Za-zÄÖÜäöüß0-9\\-\\. ]+$&quot;;</span>
<span class="fc" id="L76">        String houseNumberRegex = &quot;^[\\d]+[a-zA-Z]?$&quot;;</span>
<span class="fc" id="L77">        String cityRegex = &quot;^[A-Za-zÄÖÜäöüß\\- ]+$&quot;;</span>

<span class="fc bfc" id="L79" title="All 2 branches covered.">        if (!street.matches(streetRegex))</span>
<span class="fc" id="L80">            throw new IllegalArgumentException(&quot;Invalid street format: '&quot; + street +</span>
                    &quot;'. Must contain only letters, digits, hyphens, periods, or spaces.&quot;);
<span class="fc bfc" id="L82" title="All 2 branches covered.">        if (!houseNumber.matches(houseNumberRegex))</span>
<span class="fc" id="L83">            throw new IllegalArgumentException(&quot;Invalid house number format: '&quot; + houseNumber +</span>
                    &quot;'. Must be 1-3 digits optionally followed by a single letter (e.g., '12a').&quot;);
<span class="fc bfc" id="L85" title="All 2 branches covered.">        if (!city.matches(cityRegex))</span>
<span class="fc" id="L86">            throw new IllegalArgumentException(&quot;Invalid city format: '&quot; + city +</span>
                    &quot;'. Must contain only letters, hyphens, or spaces.&quot;);
<span class="fc" id="L88">    }</span>

    /**
     * Backward-compatible getter for street.
     */
    public String getStreet() {
<span class="fc" id="L94">        return street;</span>
    }

    /**
     * Backward-compatible getter for houseNumber.
     */
    public String getHouseNumber() {
<span class="fc" id="L101">        return houseNumber;</span>
    }

    /**
     * Backward-compatible getter for addressComplement.
     */
    public String getAddressComplement() {
<span class="fc" id="L108">        return addressComplement;</span>
    }

    /**
     * Backward-compatible getter for postalCode.
     */
    public String getPostalCode() {
<span class="fc" id="L115">        return postalCode;</span>
    }

    /**
     * Backward-compatible getter for city.
     */
    public String getCity() {
<span class="fc" id="L122">        return city;</span>
    }

    /**
     * String representation of the Address.
     */
    @Override
    public String toString() {
<span class="nc" id="L130">        return street + &quot; &quot; + houseNumber +</span>
<span class="nc bnc" id="L131" title="All 2 branches missed.">               (addressComplement.isEmpty() ? &quot;&quot; : &quot;, &quot; + addressComplement) +</span>
               &quot;, &quot; + postalCode + &quot; &quot; + city;
    }

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.11.202310140853</span></div></body></html>